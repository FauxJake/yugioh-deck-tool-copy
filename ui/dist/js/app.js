(function(e){function t(t){for(var a,i,o=t[0],s=t[1],l=t[2],u=0,p=[];u<o.length;u++)i=o[u],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&p.push(n[i][0]),n[i]=0;for(a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a]);d&&d(t);while(p.length)p.shift()();return c.push.apply(c,l||[]),r()}function r(){for(var e,t=0;t<c.length;t++){for(var r=c[t],a=!0,o=1;o<r.length;o++){var s=r[o];0!==n[s]&&(a=!1)}a&&(c.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},n={app:0},c=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],s=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=s;c.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},1501:function(e,t,r){},"1ed1":function(e,t,r){"use strict";var a=r("1501"),n=r.n(a);n.a},"566c":function(e,t,r){"use strict";var a=r("86a0"),n=r.n(a);n.a},"5c0b":function(e,t,r){"use strict";var a=r("9c0c"),n=r.n(a);n.a},"86a0":function(e,t,r){},"9c0c":function(e,t,r){},bb83:function(e,t,r){"use strict";var a=r("ffb3"),n=r.n(a);n.a},cd49:function(e,t,r){"use strict";r.r(t);r("98db");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app"},[r("div",{staticClass:"app-section app-forms"},[r("div",{staticClass:"form-group"},[r("label",[e._v("Deck:")]),r("input",{staticClass:"form-control",attrs:{accept:".ydk",title:"Upload Deck",type:"file"},on:{change:e.fileOnUpload}}),r("input",{directives:[{name:"model",rawName:"v-model",value:e.deck.name,expression:"deck.name"}],staticClass:"form-control form-deck-name",attrs:{placeholder:"Deck Title",title:"Deck Title",type:"text"},domProps:{value:e.deck.name},on:{input:function(t){t.target.composing||e.$set(e.deck,"name",t.target.value)}}}),r("button",{staticClass:"btn btn-primary form-control",attrs:{download:"Unnamed.ydk",title:"Download Deck"},on:{click:e.deckToFile}},[e._v(" Download ")])]),r("div",{staticClass:"form-group"},[r("label",[e._v("Share:")]),r("input",{staticClass:"form-control",attrs:{title:"Shareable Link",type:"url"},domProps:{value:e.shareLink}}),r("button",{staticClass:"btn btn-primary btn-tiny form-control",attrs:{disabled:e.isDeckEmpty,title:"Copy Sharelink to Clipboard"},on:{click:e.copyShareLink}},[r("span",{staticClass:"fas fa-share-square"})]),r("button",{staticClass:"btn btn-primary form-control",attrs:{disabled:e.isDeckEmpty,title:"Copy Decklist to Clipboard"},on:{click:e.copyShareText}},[e._v(" Copy Decklist to Clipboard ")])]),r("div",{staticClass:"form-group"},[r("label",[e._v("Price:")]),r("select",{directives:[{name:"model",rawName:"v-model",value:e.priceController.activeCurrency,expression:"priceController.activeCurrency"}],staticClass:"form-control form-deck-currency",attrs:{title:"Price Currency"},on:{change:function(t){var r=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.priceController,"activeCurrency",t.target.multiple?r:r[0])}}},e._l(e.priceController.currencies,(function(t){return r("option",{key:t.name,domProps:{value:t}},[e._v(" "+e._s(t.name)+" ")])})),0),r("a",{staticClass:"btn btn-primary btn-tiny form-control",class:{disabled:e.isDeckEmpty},attrs:{disabled:e.isDeckEmpty,href:e.buyLink,target:"_blank",title:"Open Buy Page"}},[r("span",{staticClass:"fas fa-shopping-cart"})]),r("button",{staticClass:"btn btn-primary form-control",attrs:{disabled:"disabled",title:"Load Prices"}},[r("span",{attrs:{hidden:e.ajax.currentlyLoading}},[e._v("Ready")]),r("span",{attrs:{hidden:!e.ajax.currentlyLoading}},[r("span",{staticClass:"fas fa-spinner fa-spin fa-fw"})])])])]),r("div",{staticClass:"app-section app-deck"},[r("h2",[e._v("Decklist:")]),e.ajax.currentlyLoading?e._e():r("ygo-deck",{attrs:{deck:e.deck}})],1)])},c=[],i=(r("5319"),r("9ab4")),o=r("5c7d"),s=r.n(o);const l=e=>{const t=document.createElement("a");t.href=window.URL.createObjectURL(e),t.download=e.name,document.body.appendChild(t),t.click(),t.remove()};var d=l;const u=e=>{const t=document.createElement("textarea");t.value=e,document.body.appendChild(t),t.select(),document.execCommand("copy"),t.remove()};var p=u,f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"deck"},[r("div",{staticClass:"deck-part deck-part-total"},[r("span",[e._v("Total:")]),r("ygo-price-view",{attrs:{cards:e.deckService.getAllCards(e.deck)}})],1),e._l(e.deckParts,(function(t){return r("ygo-deck-part",{key:t.id,class:"deck-part-"+t.id,attrs:{deck:e.deck,"deck-part":t}})}))],2)},m=[],h=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"deck-part",class:"deck-part-"+e.deckPart.id},[r("h3",[e._v(" "+e._s(e.deckPart.name)+" Deck ("+e._s(e.deck.parts.get(e.deckPart).length)+" Cards): ")]),e.deck.parts.get(e.deckPart).length>0?[r("ygo-price-view",{attrs:{cards:e.deck.parts.get(e.deckPart)}}),r("div",{staticClass:"deck-content"},e._l(e.deck.parts.get(e.deckPart),(function(t,a){return r("ygo-card",{key:t.id+"_"+a,attrs:{card:t},on:{deckcardrightclick:function(r){return r.preventDefault(),e.deckService.removeCard(e.deck,e.deckPart,t)}}},[r("ygo-price-view",{attrs:{slot:"price",cards:[t]},slot:"price"})],1)})),1)]:e._e()],2)},v=[],b=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("a",{staticClass:"deck-card",attrs:{"data-name":e.card.name,href:e.referenceUrl,target:"_blank"},on:{contextmenu:e.contextEvent}},[r("img",{attrs:{alt:e.card.name,src:e.imageUrl,height:"135",width:"100"}}),r("div",{staticClass:"deck-card-text"},[r("span",{staticClass:"deck-card-name"},[e._v(e._s(e.card.name))]),e._t("price")],2)])},g=[];const y=(...e)=>e.join("/"),k="ygoprodeck.com"===location.host,S="https://ygoprodeck.com",C=y(S,"decktool"),O=e=>y(k?C:"./",e),D="https://db.ygoprodeck.com/card/?search=",j=O("assets/unknown.png");var E=r("2fe1"),_=r("60a3");const L="Unknown";let P=class extends a["default"]{get imageUrl(){var e,t;return null!==(e=null===(t=this.card.image)||void 0===t?void 0:t.urlSmall)&&void 0!==e?e:j}get referenceUrl(){return this.card.name===L?D:D+encodeURI(this.card.name)}contextEvent(e){this.$emit("deckcardrightclick",e)}};Object(i["a"])([Object(_["a"])({required:!0})],P.prototype,"card",void 0),P=Object(i["a"])([Object(E["b"])({components:{ygoDeck:at}})],P);var R,I=P,T=I,w=(r("1ed1"),r("2877")),A=Object(w["a"])(T,b,g,!1,null,null,null),x=A.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"price",class:{"price--group":e.isGroup}},e._l(e.priceController.modes,(function(t){return r("span",{key:t.id,staticClass:"price-mode",class:"price-mode-"+t.id,attrs:{title:t.name+" Price"}},[e.isGroup?r("span",[e._v(e._s(t.name)+": ")]):e._e(),e._v(" "+e._s(e.priceController.format(e.priceValues[t.id]))+" ")])})),0)},M=[];(function(e){e[e["BANNED"]=0]="BANNED",e[e["LIMITED"]=1]="LIMITED",e[e["SEMI_LIMITED"]=2]="SEMI_LIMITED",e[e["UNLIMITED"]=3]="UNLIMITED"})(R||(R={}));const U={MAIN:{id:"main",name:"Main",indicator:"#main",min:40,max:60},EXTRA:{id:"extra",name:"Extra",indicator:"#extra",min:0,max:15},SIDE:{id:"side",name:"Side",indicator:"!side",min:0,max:15}},G=[U.MAIN,U.EXTRA,U.SIDE],B={CardDataLoaderService:Symbol.for("CardDataLoaderService"),CardDatabase:Symbol.for("CardDatabase"),CardService:Symbol.for("CardService"),DeckService:Symbol.for("DeckService"),DeckImportExportService:Symbol.for("DeckImportExportService"),PriceService:Symbol.for("PriceService"),SortingService:Symbol.for("SortingService"),CompressionService:Symbol.for("CompressionService"),EncodingService:Symbol.for("EncodingService")};var K,$=r("79c3"),F=r("d2cd"),V=r.n(F);(function(e){e["OCG"]="OCG",e["TCG"]="TCG",e["GOAT"]="GOAT",e["OCG_GOAT"]="OCG GOAT",e["SPEED_DUEL"]="Speed Duel",e["RUSH_DUEL"]="Rush Duel",e["DUEL_LINKS"]="Duel Links",e["UNKNOWN"]="UNKNOWN"})(K||(K={}));const Z=e=>"Banned"===e?R.BANNED:"Limited"===e?R.LIMITED:"Semi-Limited"===e?R.SEMI_LIMITED:R.UNLIMITED,H=e=>null==e||null==e.formats?[]:e.formats.map(e=>"TCG"===e?K.TCG:"OCG"===e?K.OCG:"GOAT"===e?K.GOAT:"OCG GOAT"===e?K.OCG_GOAT:"Speed Duel"===e?K.SPEED_DUEL:"Rush Duel"===e?K.RUSH_DUEL:"Duel Links"===e?K.DUEL_LINKS:(console.warn(`Encountered unknown format ${e}, attempting to continue.`),K.UNKNOWN)),Y=e=>null==e.card_sets?[]:e.card_sets.map(e=>({name:e.set_name,code:e.set_code,rarity:e.set_rarity,price:e.set_price})),q=e=>{if(null==e.card_images)return null;const t=e.card_images[0];return{id:t.id,url:t.image_url,urlSmall:t.image_url_small}},z=e=>{if(null==e.card_prices)return null;const t=e.card_prices[0];return{cardmarket:Number(t.cardmarket_price),tcgplayer:Number(t.tcgplayer_price),ebay:Number(t.ebay_price),amazon:Number(t.amazon_price)}},Q=e=>e.map(e=>{var t,r,a,n,c,i,o,s,l,d,u,p,f,m,h,v,b,g,y;const k=null!=e.misc_info?e.misc_info[0]:null;return{id:String(e.id),name:e.name,desc:e.desc,type:e.type,race:e.race,attribute:null!==(t=e.attribute)&&void 0!==t?t:null,atk:null!==(r=e.atk)&&void 0!==r?r:null,def:null!==(a=e.def)&&void 0!==a?a:null,level:null!==(n=e.level)&&void 0!==n?n:null,scale:null!==(c=e.scale)&&void 0!==c?c:null,linkVal:null!==(i=e.linkval)&&void 0!==i?i:null,linkMarkers:null!==(o=e.linkmarkers)&&void 0!==o?o:null,sets:Y(e),image:q(e),prices:z(e),betaName:null!==(s=null===k||void 0===k?void 0:k.beta_name)&&void 0!==s?s:null,treatedAs:null!==(l=null===k||void 0===k?void 0:k.treated_as)&&void 0!==l?l:null,archetype:null!==(d=e.archetype)&&void 0!==d?d:null,formats:H(k),release:{[K.TCG]:null!==(u=null===k||void 0===k?void 0:k.tcg_date)&&void 0!==u?u:null,[K.OCG]:null!==(p=null===k||void 0===k?void 0:k.ocg_date)&&void 0!==p?p:null},banlist:{[K.TCG]:Z(null!==(f=null===(m=e.banlist_info)||void 0===m?void 0:m.ban_tcg)&&void 0!==f?f:null),[K.OCG]:Z(null!==(h=null===(v=e.banlist_info)||void 0===v?void 0:v.ban_ocg)&&void 0!==h?h:null),[K.GOAT]:Z(null!==(b=null===(g=e.banlist_info)||void 0===g?void 0:g.ban_goat)&&void 0!==b?b:null)},views:null!==(y=null===k||void 0===k?void 0:k.views)&&void 0!==y?y:0}}),X=e=>e.map(e=>({name:e.set_name,code:e.set_code}));var W;(function(e){e["MONSTER"]="MONSTER",e["SPELL"]="SPELL",e["TRAP"]="TRAP",e["SKILL"]="SKILL"})(W||(W={}));const J=e=>"SKILL"===e.group?W.SKILL:"SPELL"===e.group?W.SPELL:"TRAP"===e.group?W.TRAP:W.MONSTER,ee=e=>new Set(e.area.map(e=>"SIDE"===e?U.SIDE:"EXTRA"===e?U.EXTRA:U.MAIN)),te=e=>({types:e.types.map(e=>({name:e.name,group:J(e),sortGroup:e.sortGroup,deckPart:ee(e)})),values:{[W.MONSTER]:{races:e.MONSTER.race,attributes:e.MONSTER.attributes,levels:e.MONSTER.level,linkMarkers:e.MONSTER.linkmarkers},[W.SPELL]:{races:e.SPELL.race},[W.TRAP]:{races:e.TRAP.race},[W.SKILL]:{races:e.SKILL.race}}});var re,ae=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},ne=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let ce=re=class{constructor(){this.httpClient=V.a.create({baseURL:"https://db.ygoprodeck.com/api/v7/",timeout:3e3,responseType:"json",validateStatus:e=>200===e})}async getCardInfo(){const e=await this.loadPaginated(re.CARD_INFO_CHUNK_SIZE,async e=>{const t=await this.httpClient.get("cardinfo.php",{params:{misc:"yes",includeAliased:"yes",num:re.CARD_INFO_CHUNK_SIZE,offset:e}});return t.data});return Q(e)}async getCardSets(){const e=await this.httpClient.get("cardsets.php");return X(e.data)}async getCardValues(){const e=await this.httpClient.get("cardvalues.php");return te(e.data)}async loadPaginated(e,t){const r=[];let a=0,n=null;while(null==n||r.length<n){const c=await t(a);r.push(...c.data),null==n&&(n=c.meta.total_rows),a+=e}return r}};ce.CARD_INFO_CHUNK_SIZE=2500,ce=re=ae([Object($["injectable"])(),ne("design:paramtypes",[])],ce);var ie=r("8053"),oe=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i};let se=class{deflate(e){return Object(ie["deflate"])(e)}inflate(e){return Object(ie["inflate"])(e)}inflateString(e){return Object(ie["inflate"])(e,{to:"string"})}};se=oe([Object($["injectable"])()],se);var le=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},de=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},ue=function(e,t){return function(r,a){t(r,a,e)}};let pe=class{constructor(e){this.dataLoaderClient=e,this.cards=new Map,this.sets=[],this.types=[],this.races=new Map,this.monsterAttributes=[],this.monsterLinkMarkers=[],this.monsterLevels=[],this.ready=!1}async init(){const[e,t,r]=await Promise.all([this.dataLoaderClient.getCardInfo(),this.dataLoaderClient.getCardSets(),this.dataLoaderClient.getCardValues()]);this.sets.push(...t),this.types.push(...r.types),this.races.set(W.MONSTER,r.values[W.MONSTER].races),this.races.set(W.SPELL,r.values[W.SPELL].races),this.races.set(W.TRAP,r.values[W.TRAP].races),this.races.set(W.SKILL,r.values[W.SKILL].races),this.monsterAttributes.push(...r.values[W.MONSTER].attributes),this.monsterLevels.push(...r.values[W.MONSTER].levels),this.monsterLinkMarkers.push(...r.values[W.MONSTER].linkMarkers);for(const a of e)this.cards.set(a.id,this.createLinkedCard(a,t,r));this.ready=!0}isReady(){return this.ready}hasCard(e){return this.cards.has(e)}getCard(e){var t;return null!==(t=this.cards.get(e))&&void 0!==t?t:null}getCards(){return Array.from(this.cards.values())}getSets(){return this.sets}getTypes(){return this.types}getRaces(e){return this.races.get(e)}getMonsterAttributes(){return this.monsterAttributes}getMonsterLevels(){return this.monsterLevels}getMonsterLinkMarkers(){return this.monsterLinkMarkers}createLinkedCard(e,t,r){return{id:e.id,name:e.name,desc:e.desc,type:this.linkType(e.type,r.types),race:e.race,attribute:e.attribute,atk:e.atk,def:e.def,level:e.level,scale:e.scale,linkVal:e.linkVal,linkMarkers:e.linkMarkers,sets:this.linkSets(e.sets,t),image:e.image,prices:e.prices,betaName:e.betaName,treatedAs:e.treatedAs,archetype:e.archetype,formats:e.formats,release:e.release,banlist:e.banlist,views:e.views}}linkSets(e,t){return e.map(e=>{const r=t.find(t=>t.name===e.name);return null==r?(console.warn(`Could not find set '${e.name}'.`),null):r}).filter(e=>null!=e)}linkType(e,t){const r=t.find(t=>t.name===e);if(null==r)throw new TypeError(`Could not find type '${e}'.`);return r}};pe=le([Object($["injectable"])(),ue(0,Object($["inject"])(B.CardDataLoaderService)),de("design:paramtypes",[Object])],pe);var fe=r("a1f6"),me=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i};let he=class{isTreatedAsSame(e,t){return Object(fe["intersection"])(this.getAllNames(e),this.getAllNames(t)).length>0}getAllNames(e){const t=[e.name];return null!=e.treatedAs&&t.push(e.treatedAs),t}};he=me([Object($["injectable"])()],he);var ve=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i};let be=class{hasPrice(e){return null!=e.prices}getPrice(...e){const t=e.filter(e=>!this.hasPrice(e)),r=e.filter(e=>this.hasPrice(e)).map(e=>e.prices).reduce((e,t)=>this.createPrices(e.cardmarket+t.cardmarket,e.tcgplayer+t.tcgplayer,e.ebay+t.ebay,e.amazon+t.amazon),this.createPrices(0,0,0,0));return{prices:r,missing:t}}createPrices(e,t,r,a){return{cardmarket:e,tcgplayer:t,ebay:r,amazon:a}}};be=ve([Object($["injectable"])()],be);var ge=r("b4e6"),ye=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},ke=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Se=function(e,t){return function(r,a){t(r,a,e)}};let Ce=class{constructor(e){this.cardService=e}canAdd(e,t,r,a){if(!a.type.deckPart.has(t))return!1;const n=e.parts.get(t).length;if(n+1>t.max)return!1;const c=this.getAllCards(e).filter(e=>this.cardService.isTreatedAsSame(e,a)).length;return c<a.banlist[r]}addCard(e,t,r){e.parts.get(t).push(r)}removeCard(e,t,r){e.parts.set(t,Array.from(Object(ge["b"])(e.parts.get(t),r,!1)))}getAllCards(e){const t=[];for(const r of G)t.push(...e.parts.get(r));return t}createEmptyDeck(){const e=new Map;for(const t of G)e.set(t,[]);return{name:null,parts:e}}};Ce=ye([Object($["injectable"])(),Se(0,Object($["inject"])(B.CardService)),ke("design:paramtypes",[he])],Ce);var Oe=r("d9c8"),De=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},je=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)};let Ee=class{constructor(){this.textEncoder=new TextEncoder,this.textDecoder=new TextDecoder}encodeString(e){return this.textEncoder.encode(e)}decodeString(e){return this.textDecoder.decode(e)}encodeUriSafeBase64String(e){return Object(Oe["fromByteArray"])(e).replace(/=/g,"~").replace(/\+/g,"_").replace(/\//g,"-")}decodeUriSafeBase64String(e){return Object(Oe["toByteArray"])(e.replace(/~/g,"=").replace(/_/g,"+").replace(/-/g,"/"))}};Ee=De([Object($["injectable"])(),je("design:paramtypes",[])],Ee);var _e,Le=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},Pe=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Re=function(e,t){return function(r,a){t(r,a,e)}};let Ie=_e=class{constructor(e,t,r,a){this.encodingService=r,this.compressionService=a,this.deckService=t,this.cardDatabase=e}fromFile(e){const t=[],r=this.deckService.createEmptyDeck(),a=e.fileContent.split("\n").map(e=>e.trim()).filter(e=>e.length>0);let n=null;for(const c of a){const e=G.find(e=>e.indicator===c);if(null==e){if(null!=n)if(this.cardDatabase.hasCard(c)){const e=this.cardDatabase.getCard(c);r.parts.get(n).push(e)}else t.push(c)}else n=e}return r.name=e.fileName.replace(".ydk",""),{deck:r,missing:t}}toFile(e){var t;const r=[];for(const a of G){const t=e.parts.get(a);r.push(a.indicator),r.push(...t.map(e=>e.id)),r.push("")}return{fileName:`${null!==(t=e.name)&&void 0!==t?t:"Unnamed"}.ydk`,fileContent:r.join("\n")}}toUrlQueryParamValue(e){const t=[];for(const a of G){for(const r of e.parts.get(a))t.push(...this.encodeCard(r));t.push(..._e.DELIMITER_BLOCK)}null!=e.name&&""!==e.name&&t.push(...this.encodingService.encodeString(e.name));const r=this.compressionService.deflate(t);return this.encodingService.encodeUriSafeBase64String(r)}fromUrlQueryParamValue(e){const t=this.deckService.createEmptyDeck(),r=this.encodingService.decodeUriSafeBase64String(e),a=this.compressionService.inflate(r);let n=0,c=null;for(let i=0;i<a.length;i+=_e.BLOCK_SIZE){const e=a.subarray(i,i+_e.BLOCK_SIZE);if(Object(fe["isEqual"])(e,_e.DELIMITER_BLOCK)){if(n===G.length-1){c=i+_e.BLOCK_SIZE;break}n++}else{const r=t.parts.get(G[n]);r.push(this.decodeCard(e))}}return null!=c&&c<a.length&&(t.name=this.encodingService.decodeString(a.subarray(c))),t}fromLegacyUrlQueryParamValue(e,t){const r=this.deckService.createEmptyDeck(),a=this.compressionService.inflateString(t(e)),n={deckPart:"|",cardId:";",cardAmount:"*"};return a.split(n.deckPart).forEach((e,t)=>{const a=G[t],c=r.parts.get(a);e.length>0&&e.split(n.cardId).forEach(e=>{let t=1,r=e;if(e.startsWith(n.cardAmount)&&(t=Number(e[1]),r=e.slice(2)),!this.cardDatabase.hasCard(r))throw new TypeError(`Unknown card ${r}, this hopefully should never happen.`);const a=this.cardDatabase.getCard(r);for(let n=0;n<t;n++)c.push(a)})}),r}toShareableText(e){const t=[];for(const r of G){t.push(`${r.name}:`);const a=e.parts.get(r),n=this.countCards(a);for(const[e,r]of n.entries())t.push(`${e.name} x${r}`);t.push("")}return t.join("\n")}toBuyLink(e){const t=this.countCards(this.deckService.getAllCards(e)),r=Array.from(t.entries()).map(([e,t])=>`${t} ${e.name}`);return"https://store.tcgplayer.com/massentry?partner=YGOPRODeck&productline=Yugioh&c="+encodeURIComponent(["",...r,""].join("||"))}encodeCard(e){const t=Number(e.id);if(0===t||t>=_e.ID_LIMIT)throw new TypeError(`Card '${e}' has an illegal value ${t} as ID.`);const r=new ArrayBuffer(_e.BLOCK_SIZE),a=new Uint32Array(r);return a[0]=t,new Uint8Array(r)}decodeCard(e){const t=new Uint8Array(e),r=new Uint32Array(t.buffer),a=String(r[0]);if(!this.cardDatabase.hasCard(a))throw new TypeError(`Could not find card for ID ${a}.`);return this.cardDatabase.getCard(a)}countCards(e){return Object(ge["a"])(e,e=>e,()=>0,e=>e+1)}};Ie.BLOCK_SIZE=4,Ie.DELIMITER_BLOCK=new Uint8Array(_e.BLOCK_SIZE).fill(0),Ie.ID_LIMIT=2**32,Ie=_e=Le([Object($["injectable"])(),Re(0,Object($["inject"])(B.CardDatabase)),Re(1,Object($["inject"])(B.DeckService)),Re(2,Object($["inject"])(B.EncodingService)),Re(3,Object($["inject"])(B.CompressionService)),Pe("design:paramtypes",[Object,Ce,Ee,se])],Ie);var Te=function(e,t,r,a){var n,c=arguments.length,i=c<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,r):a;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,a);else for(var o=e.length-1;o>=0;o--)(n=e[o])&&(i=(c<3?n(i):c>3?n(t,r,i):n(t,r))||i);return c>3&&i&&Object.defineProperty(t,r,i),i},we=function(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)},Ae=function(e,t){return function(r,a){t(r,a,e)}};let xe=class{constructor(e){this.cardDatabase=e}shuffle(e){return Object(fe["shuffle"])(e)}sort(e){return e.sort((e,t)=>{if(e.type.sortGroup!=t.type.sortGroup)return t.type.sortGroup-e.type.sortGroup;if(e.type.group!==W.MONSTER&&e.race!=t.race){const r=this.cardDatabase.getRaces(e.type.group);return r.indexOf(e.race)-r.indexOf(t.race)}return e.type.group===W.MONSTER&&e.level!==t.level?e.level-t.level:e.name.localeCompare(t.name)})}};xe=Te([Object($["injectable"])(),Ae(0,Object($["inject"])(B.CardDatabase)),we("design:paramtypes",[Object])],xe);const Ne=new $["Container"];Ne.bind(B.CardDataLoaderService).to(ce),Ne.bind(B.CardService).to(he),Ne.bind(B.DeckImportExportService).to(Ie),Ne.bind(B.DeckService).to(Ce),Ne.bind(B.PriceService).to(be),Ne.bind(B.SortingService).to(xe),Ne.bind(B.CompressionService).to(se),Ne.bind(B.EncodingService).to(Ee),Ne.bind(B.CardDatabase).to(pe).inSingletonScope();const Me=Object.assign({PriceController:Symbol.for("PriceController")},B),Ue=[{id:"tcgplayer",name:"TCGPlayer"},{id:"cardmarket",name:"Cardmarket"},{id:"ebay",name:"eBay"}],Ge=[{name:"US Dollar",locale:"en-US",id:"USD",val:1,fractionDigits:2,formatter:null},{name:"Euro",locale:"de-DE",id:"EUR",val:.881,fractionDigits:2,formatter:null},{name:"British Pound",locale:"en-GB",id:"GBP",val:.792,fractionDigits:2,formatter:null},{name:"Canadian Dollar",locale:"en-CA",id:"CAD",val:1.341,fractionDigits:2,formatter:null},{name:"Australian Dollar",locale:"en-AU",id:"AUD",val:1.393,fractionDigits:2,formatter:null},{name:"Mexican Peso",locale:"es-MX",id:"MXN",val:20.09,fractionDigits:1,formatter:null},{name:"Brazilian Real",locale:"pt-BR",id:"BRL",val:3.9,fractionDigits:1,formatter:null},{name:"Thai Baht",locale:"th-TH",id:"THB",val:32.8,fractionDigits:0,formatter:null},{name:"Indonesian Rupiah",locale:"id-ID",id:"IDR",val:14578,fractionDigits:0,formatter:null}];var Be=r("e1c6");let Ke=class{constructor(){this.modes=Ue,this.currencies=this.mapCurrencyFormatters(),this.activeCurrency=this.guessDefaultCurrency()}format(e){const t=this.activeCurrency;return t.formatter.format(e*t.val)}mapCurrencyFormatters(){return Ge.map(e=>(e.formatter=new Intl.NumberFormat(e.locale,{style:"currency",currency:e.id,minimumFractionDigits:e.fractionDigits,maximumFractionDigits:e.fractionDigits}),e))}guessDefaultCurrency(){const e=Ge.findIndex(e=>e.locale===navigator.language);return-1===e?Ge[0]:Ge[e]}};Ke=Object(i["a"])([Object(Be["injectable"])()],Ke);const $e=Ne.createChild();$e.bind(Me.PriceController).to(Ke).inSingletonScope();let Fe=class extends a["default"]{constructor(){super(...arguments),this.priceController=$e.get(Me.PriceController),this.priceService=$e.get(Me.PriceService)}get isGroup(){return this.cards.length>1}get priceValues(){return this.priceService.getPrice(...this.cards).prices}};Object(i["a"])([Object(_["a"])()],Fe.prototype,"cards",void 0),Fe=Object(i["a"])([Object(E["b"])({})],Fe);var Ve=Fe,Ze=Ve,He=(r("566c"),Object(w["a"])(Ze,N,M,!1,null,null,null)),Ye=He.exports;let qe=class extends a["default"]{constructor(){super(...arguments),this.cardDatabase=$e.get(Me.CardDatabase),this.deckService=$e.get(Me.DeckService)}};Object(i["a"])([Object(_["a"])({required:!0})],qe.prototype,"deck",void 0),Object(i["a"])([Object(_["a"])({required:!0})],qe.prototype,"deckPart",void 0),qe=Object(i["a"])([Object(E["b"])({components:{YgoCard:x,YgoPriceView:Ye}})],qe);var ze=qe,Qe=ze,Xe=(r("bb83"),Object(w["a"])(Qe,h,v,!1,null,null,null)),We=Xe.exports;let Je=class extends a["default"]{constructor(){super(...arguments),this.deckService=$e.get(Me.DeckService),this.deckParts=G}};Object(i["a"])([Object(_["a"])({required:!0})],Je.prototype,"deck",void 0),Je=Object(i["a"])([Object(E["b"])({components:{YgoDeckPart:We,YgoPriceView:Ye}})],Je);var et=Je,tt=et,rt=Object(w["a"])(tt,f,m,!1,null,null,null),at=rt.exports;const nt=e=>new Promise((t,r)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=()=>r(a.error),a.readAsText(e)});s.a.setLevel(o["levels"].INFO);let ct=class extends a["default"]{constructor(){super(...arguments),this.ajax={currentlyLoading:!0},this.cardDatabase=$e.get(Me.CardDatabase),this.deckService=$e.get(Me.DeckService),this.deck=this.deckService.createEmptyDeck(),this.deckImportExportService=$e.get(Me.DeckImportExportService),this.priceController=$e.get(Me.PriceController)}get shareLink(){const e=location.origin+location.pathname,t=this.deckImportExportService.toUrlQueryParamValue(this.deck);return`${e}?e=${t}`}get buyLink(){return this.deckImportExportService.toBuyLink(this.deck)}get isDeckEmpty(){return 0===this.deckService.getAllCards(this.deck).length}deckToFile(){const{fileName:e,fileContent:t}=this.deckImportExportService.toFile(this.deck);d(new File([t],e))}canAdd(e,t,r){return this.deckService.canAdd(this.deck,e,r,t)}cardAdd(e,t){return this.deckService.addCard(this.deck,e,t)}fileOnUpload(e){const t=e.target.files||e.dataTransfer.files;if(t.length>0){const e=t[0];nt(e).then(t=>{const r=this.deckImportExportService.fromFile({fileContent:t,fileName:e.name});this.deck=r.deck}).catch(s.a.error)}}copyShareLink(){p(this.shareLink)}copyShareText(){p(this.deckImportExportService.toShareableText(this.deck))}mounted(){this.ajax.currentlyLoading=!0,this.cardDatabase.init().then(()=>(this.ajax.currentlyLoading=!1,this.loadUriDeck())).then(()=>s.a.info("Ready.")).catch(s.a.error)}async loadUriDeck(){const e=location.search;return e.includes("?u=")?fetch(e.replace("?u=","")).then(e=>e.text()).then(e=>{this.deck=this.deckImportExportService.fromFile({fileContent:e,fileName:null}).deck}):(e.includes("?e=")?this.deck=this.deckImportExportService.fromUrlQueryParamValue(e.replace("?e=","")):e.includes("?d=")&&(this.deck=this.deckImportExportService.fromLegacyUrlQueryParamValue(e.replace("?d=",""),atob)),Promise.resolve())}};ct=Object(i["a"])([Object(E["b"])({components:{YgoDeck:at},name:"Index"})],ct);var it=ct,ot=it,st=(r("5c0b"),Object(w["a"])(ot,n,c,!1,null,null,null)),lt=st.exports,dt=r("5f5b");a["default"].use(dt["a"]),new a["default"]({render:e=>e(lt)}).$mount("#decktoolApp")},ffb3:function(e,t,r){}});
//# sourceMappingURL=app.js.map